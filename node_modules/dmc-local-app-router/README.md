# dmc-local-app-router

local app router used to run the DMC Custom View plugins locally without deploying to DMC.

## Installation
run below commond to install latest version of module. here -g represents global installation. if you want to install locally, remove -g in below command.

```bash
npm i dmc-local-app-router@latest -g
```

## Use
1. create `local-configs.json` file in the custom plugin root directory with below configs

```js

{
    "port": 8085, //port number
    "localDir":"commonLib/lib", //(optional), it optional config. by default folder path maintained in mta.yaml file is used to serve the application. if specified, this property takes precedence
    "manufacturing-execution-service": "https://<host>-#service#-ms.cfapps.eu20.hana.ondemand.com", //(depricated)integration URL to make internal API calls. it is depricated, so dont use this.
    "routes":[
        //public API router
        {
            "route":"/api/:servicePath*", //DMC Public API route
            "uri":"https://api.test.<origin>.dmc.cloud.sap", // DMC Public API end point
            "auth":"papiAuth" // Authorization, its user defined name. Maintain configs for this in auths section of this JSON file
        },
        //External API router
        {
            "route":"/capService/:servicePath*", // Any external router, its user define route
            "uri":"https://<host>.cfapps.eu20.hana.ondemand.com", //Any external service end point like cap application
            "auth":"capServiceAuth" //Authorization
        },
        //Static resource like common libraries, you can remove auth field
        {
            "route":"/commonLib/:servicePath*", 
            "uri":"https://<host>cfapps.eu20.hana.ondemand.com"
        }
    ],
    "auths":{
         //Public API  oAuth Config
        "papiAuth":{
            "authUrl": "https://<host>.authentication.eu20.hana.ondemand.com/oauth/token", //Authorixation URL
            "clientId": "<clientID>",
            "clientSecret": "<client Secret>"
        },
        //External Service oAuth Config
        "capServiceAuth":{
            "authUrl": "https://<host>.authentication.eu20.hana.ondemand.com/oauth/token", //Authorixation URL
            "clientId": "<clientID>",
            "clientSecret": "<client Secret>"
        }
    }
}

```

2. In package.json file add below start script to run the app;

```js

{
    .....
    "scripts": {
      ...
      "start":"node node_modules/dmc-local-app-router/server.js",
      "start-g":"node $(npm root -g)/dmc-local-app-router/server.js", //only works for mac users
      ....
    },
    ...
  }

```

3. run `npm run start` command in root folder to start the application.

## Relese Updates
### 1.0.7 Version
    Below changes made as part of this patch
    1. Made 'auth' field in routes as optional field so you can add static resource routes without authorization
    2. Added 'localDir' field to control while folder to be served
    3. Added ReadME.md file with documentation





